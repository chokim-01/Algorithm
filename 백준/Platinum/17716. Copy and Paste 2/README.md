# [Platinum III] Copy and Paste 2 - 17716 

[문제 링크](https://www.acmicpc.net/problem/17716) 

### 성능 요약

메모리: 145260 KB, 시간: 1424 ms

### 분류

구현, 재귀, 시뮬레이션

### 문제 설명

<p>テキストエディタの最も重要な機能の 1 つとして，コピー＆ペースト (複写・貼付) がある．JOI 社は，コ ピー＆ペーストを非常に高速に処理するテキストエディタの開発を進めている．JOI 社に所属する優秀な プログラマであるあなたは，核となるコピー＆ペースト処理のテストの担当となった．JOI 社の命運が懸 かっているので，何としても正確かつ高速なプログラムを作成したい．</p>

<p>具体的な仕様は次のとおりである．初め，ファイルの内容は文字列 S である．引き続いて，コピー＆ペー ストの操作が N 回行われる．i 回目の操作は，位置 A<sub>i</sub> から位置 B<sub>i</sub> までの文字列を複写し，複写された文 字列を元の文字列の位置 C<sub>i</sub> に挿入貼付する，というものである．ここで，位置 x とは，文字列の先頭から x 個の文字をたどった直後の箇所を表す (位置 0 は文字列の先頭である)．例えば，文字列 copypaste の位 置 6 とは，文字 ‘a’ と文字 ‘s’ の間を表す．位置 9 は文字 ‘e’ の後ろ，すなわち，この文字列の末尾を表す． ただし，操作後に文字列の長さが M を超えた場合，長さが M になるまで文字列の右端から順に文字が削 除される．</p>

<p>あなたの任務は，エディタのテストのため，N 回の操作後に得られる文字列の最初の K 文字を予め求め ておくことである．</p>

<p>整数 K，文字列の長さの上限 M，初めの文字列 S，操作の回数 N および N 回のコピー＆ペーストの操 作の指示が与えられたとき，操作後の文字列の最初の K 文字を求めるプログラムを作成せよ．</p>

### 입력 

 <p>標準入力から以下の入力を読み込め．</p>

<ul>
	<li>1 行目には，整数 K, M が空白を区切りとして書かれている．K は出力する文字数を表し，M は文字 列の長さの上限を表す．</li>
	<li>2 行目には，文字列 S が書かれており，初めの文字列を表す．</li>
	<li>3 行目には，整数 N が書かれており，操作の回数を表す．</li>
	<li>続く N 行のうちの i 行目 (1 ≦ i ≦ N) には，整数 A<sub>i</sub>, B<sub>i</sub>, C<sub>i</sub> が空白を区切りとして書かれている．これ は，i 回目の操作は位置 A<sub>i</sub> から位置 B<sub>i</sub> までの文字列を複写し位置 C<sub>i</sub> に挿入貼付する，というもので あることを表す．</li>
</ul>

### 출력 

 <p>標準出力に，N 回の操作後の文字列の最初の K 文字を 1 行で出力せよ．</p>

